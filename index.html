<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Mobile OTP Login</title>
<style>
body {
  font-family: Arial;
  background: #f2f2f2;
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.container {
  background: #fff;
  padding: 25px;
  border-radius: 8px;
  width: 320px;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
}
input {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border: 1px solid #ccc;
  border-radius: 5px;
}
button {
  width: 100%;
  padding: 12px;
  background: #0066ff;
  color: #fff;
  font-size: 16px;
  border: none;
  cursor: pointer;
  margin-top: 5px;
  border-radius: 5px;
}
#otp-box {
  display: none;
}
</style>
</head>
<body>

<div class="container">
    <h3>Mobile OTP Login</h3>

    <input type="text" id="phone" placeholder="Enter Mobile Number (e.g. +91xxxxxxxxxx)">
    <div id="recaptcha-container"></div>
    <button onclick="sendOTP()">Send OTP</button>

    <div id="otp-box">
        <input type="text" id="otp" placeholder="Enter OTP">
        <button onclick="verifyOTP()">Verify OTP</button>
    </div>
</div>

<!-- Firebase Config -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.5.0/firebase-app.js";
import { 
  getAuth, 
  RecaptchaVerifier, 
  signInWithPhoneNumber 
} from "https://www.gstatic.com/firebasejs/12.5.0/firebase-auth.js";

const firebaseConfig = {
  apiKey: "AIzaSyD9IrRF15IfzYEfwQTl_JA_ie4SyaPCUfU",
  authDomain: "otp-login-form-e13e2.firebaseapp.com",
  projectId: "otp-login-form-e13e2",
  storageBucket: "otp-login-form-e13e2.firebasestorage.app",
  messagingSenderId: "345706715094",
  appId: "1:345706715094:web:d0fd55ebe741ea1871b677"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// Recaptcha Setup
window.recaptchaVerifier = new RecaptchaVerifier(
  auth,
  "recaptcha-container",
  {
    size: "normal",
  }
);

// Send OTP
window.sendOTP = function () {
  const phone = document.getElementById("phone").value;
  if (phone.length < 10) return alert("Enter valid phone number");

  signInWithPhoneNumber(auth, phone, window.recaptchaVerifier)
    .then((confirmationResult) => {
      window.confirmationResult = confirmationResult;
      alert("OTP Sent!");
      document.getElementById("otp-box").style.display = "block";
    })
    .catch((error) => {
      alert(error.message);
    });
}

// Verify OTP
window.verifyOTP = function () {
  const otp = document.getElementById("otp").value;
  confirmationResult.confirm(otp)
    .then((result) => {
      alert("✅ Login Successful");
      console.log("User:", result.user);
    })
    .catch((error) => {
      alert("❌ Invalid OTP");
    });
}
</script>

</body>
</html>
